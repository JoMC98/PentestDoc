# Source

`Try Hack Me` `Linux` `CVE-2019-15107` `Metasploit` `Webmin`

## Flags

* **User Flag:** `THM{SUPPLY_CHAIN_COMPROMISE}`
* **Root Flag:** `THM{UPDATE_YOUR_INSTALL}`

## Users

* dark

## **Enumeración**

Vemos si el host esta levantado y identificamos el SSOO con `ping -c1 IP`

> Linux: TTL &lt;= 64
>
> Windows: TTL &gt;= 65 & &lt;= 128

![](https://i.imgur.com/UeJXcGv.png)

### Escaneo de puertos

Primero vemos si va muy lento el escaneo: `nmap -p- --open -T5 -v -n IP`

```text
-p-         Todos los puertos 
--open      Mostrar solos puertos abiertos 
-T5         Modo más agresivo 
-v          Modo verbose (reporta por pantalla) 
-n          No aplicar resolución DNS
```

Como va lento, lanzamos este otro comando: `nmap -sS --min-rate 5000 -p- -vvv -n -Pn IP`

```text
-sS           Realizar un TCP SYN port scan
--min-rate    Emitir al menos 5000 paquetes por segundo
-Pn           No realizar Host Discovery
```

Va más rápido y encuentra los puertos 22 \(SSH\) y 80 \(HTTP\)

![](https://i.imgur.com/w64fdi1.png)

Obtenemos los servicios que corren en los puertos `nmap -sC -sV -p22,10000 IP`

![](https://i.imgur.com/OwEkUug.png)

### Servicio Webmin HTTP

Accedemos a la web y vemos error SSL

![](https://i.imgur.com/uAbmaXe.png)

Accedemos con HTTPS por **`https://IP:10000`**

![](https://i.imgur.com/BeCsxxi.png)

> Probamos con whatweb, Wappalyzer y fuzzing con GoBuster pero no vemos nada.

Sabemos que la versión de Webmin es la **`1.890`**. Buscamos y vemos exploits.

![](https://i.imgur.com/dq7j0MZ.png)

Probamos este [exploit](https://www.exploit-db.com/exploits/47293) y nos dice que no es vulnerable.

Probamos este otro, que es para la versión **`1.920`**, debería valer. Pertenece al **`CVE-2019-15107`**,

{% embed url="https://www.exploit-db.com/exploits/47230" caption="" %}

![](https://i.imgur.com/e0s5c8Z.png)

## Metasploit - Shell and Privilege Escalation

Abrimos Metasploit y buscamos el exploit con `search webmin` y lo elegimos con `use NUM`.

![](https://i.imgur.com/WGLlA9S.png)

Configuramos todos los parámetros con **`SET`**

![](https://i.imgur.com/aj9fpj1.png)

Ejecutamos el exploit con **`run`**

![](https://i.imgur.com/7APUhH8.png)

Conseguimos el acceso a la máquina y además somos root.

![](https://i.imgur.com/q29NvnK.png)

### **User and root Flag**

Tenemos ya ambas flags, una en **`/home/dark`** y la otra en **`/root`**

{% hint style="success" %}
USER FLAG: **`THM{SUPPLY_CHAIN_COMPROMISE}`**
{% endhint %}

{% hint style="success" %}
ROOT FLAG: **`THM{UPDATE_YOUR_INSTALL}`**
{% endhint %}

