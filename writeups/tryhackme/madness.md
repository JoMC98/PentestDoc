# Madness

`Try Hack Me` `Linux` `Stego` `BruteForce` `screen` `SUID` `ExploitDB`

## Flags

* **User Flag:** THM{d5781e53b130efe2f94f9b0354a5e4ea}
* **Root Flag:** THM{5ecd98aa66a6abb670184d7547c8124a}

## Users

* joker _\(pwd: axA&GF8dP\)_

## **Enumeración**

1. Vemos si el host esta levantado y saber el SSOO \(**Linux**: TTL &lt;= 64\) \`ping -c1 IP\`
   1. `ping -c1 IP`
2. Escaneamos los puertos abiertos
   * Primero vemos si va muy lento el escaneo: `nmap -p- --open -T5 -v -n IP`

     ```text
       -p-        Todos los puertos
       --open     Mostrar solos puertos abiertos
       -T5        Modo más agresivo
       -v         Modo verbose (reporta por pantalla)
       -n        No aplicar resolución DNS
     ```

   * Como va lento, lanzamos este otro comando: `nmap -sS --min-rate 5000 -p- -vvv -n -Pn IP`

     ```text
       -sS        Realizar un TCP SYN port scan
       --min-rate    Emitir al menos 5000 paquetes por segundo
       -Pn        No realizar Host Discovery
     ```

     * Va más rápido y encuentra los puertos 22 \(SSH\) y 80 \(HTTP\)

       ![](https://i.imgur.com/Kaxg51I.png)
3. Obtenemos los servicios que corren en los puertos `nmap -sC -sV -p22,80 IP`

   ![](https://i.imgur.com/AXmB3U2.png)

4. Nos centramos en el servidor web Apache. Lanzamos un whatweb para ver si usa algún CMS tipo Wordpress, pero vemos que no, es un Apache normal

   ![](https://i.imgur.com/2Rjqchi.png)

5. Accedemos al portal web y vemos la página por defecto de apache. Vemos el código fuente de la página a ver si encontramos algo. No hay nada
6. Vamos a hacer un fuzzing en el portal para encontrar alguna ruta con GoBuster

   `gobuster dir -u IP -w DICT -q -n -e`

   ```text
        -u        Target 
        -w         Diccionario (/usr/share/wordlists/dirb/common.txt)
        -q        Silencioso, no muestra mensajes de estado           
        -n        No muestra códigos de estado        
        -e        Muestra URLs completas
   ```

   ![](https://i.imgur.com/dt0qCBd.png)

7. No encontramos nada en el fuzzing. Volvemos al portal y vemos algo raro:

   ![](https://i.imgur.com/ebjNqxh.png)

   * En el código fuente vemos una sorpresita que no habiamos visto antes:

     ![](https://i.imgur.com/89kKjbn.png)



